<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>My Hugging Face Chat</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; }
    #chat { border: 1px solid #ccc; padding: 10px; height: 400px; overflow-y: auto; }
    .msg-user { color: blue; margin: 5px 0; }
    .msg-bot { color: green; margin: 5px 0; }
    #inputArea { margin-top: 10px; display: flex; gap: 5px; }
    #userInput { flex: 1; padding: 5px; }
  </style>
</head>
<body>
  <h2>Chat with HF Model</h2>
  <div id="chat"></div>

  <div id="inputArea">
    <input id="userInput" type="text" placeholder="Type your message..." />
    <button onclick="sendMessage()">Send</button>
  </div>

  <script>
    const HF_TOKEN = "tok_70a5565fc132f0b1db75300f24d8e1da";
    const MODEL_ID = "mistralai/Mistral-7B-Instruct-v0.2";

    const chatDiv = document.getElementById("chat");
    const userInput = document.getElementById("userInput");

    async function sendMessage() {
      const text = userInput.value.trim();
      if (!text) return;

      addMessage("You: " + text, "msg-user");
      userInput.value = "";

      const loadingElem = addMessage("Assistant: ...", "msg-bot");

      try {
        const response = await fetch(
          "https://api-inference.huggingface.co/models/" + MODEL_ID,
          {
            method: "POST",
            headers: {
              "Authorization": "Bearer " + HF_TOKEN,
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              inputs: text,
              parameters: {
                max_new_tokens: 200,
                temperature: 0.7
              }
            })
          }
        );

        const data = await response.json();

        let reply = "";
        if (Array.isArray(data) && data[0] && data[0].generated_text) {
          reply = data[0].generated_text;
        } else if (data.error) {
          reply = "Error: " + data.error;
        } else {
          reply = JSON.stringify(data);
        }

        updateMessage(loadingElem, "Assistant: " + reply);
      } catch (e) {
        updateMessage(loadingElem, "Assistant: Error calling API: " + e.message);
      }
    }

    function addMessage(text, cls) {
      const p = document.createElement("p");
      p.className = cls;
      p.textContent = text;
      chatDiv.appendChild(p);
      chatDiv.scrollTop = chatDiv.scrollHeight;
      return p;
    }

    function updateMessage(element, newText) {
      element.textContent = newText;
      chatDiv.scrollTop = chatDiv.scrollHeight;
    }

    userInput.addEventListener("keyup", function(e) {
      if (e.key === "Enter") sendMessage();
    });
  </script>
</body>
</html>
